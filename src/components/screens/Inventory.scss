// src/components/Inventory.scss
@use 'sass:color'; // Импортируем модуль sass:color

// --- ПЕРЕМЕННЫЕ ЦВЕТОВ РЕДКОСТИ ---
// !!! Убедись, что эти переменные определены в твоем проекте или раскомментируй/настрой их здесь !!!
$rarity-color-common: #b0b0b0 !default;     // Используем значения из код1 как предпочтительные
$rarity-color-uncommon: #66bb66 !default;   // Зеленый
$rarity-color-rare: #5599ff !default;       // Синий
$rarity-color-epic: #A020F0 !default;
$rarity-color-legendary: #ffaa44 !default;  // Оранжево-золотой
$rarity-color-mythic: #cc66ff !default;     // Фиолетовый
$bright-green-arrow: #20C20E;
// ----------------------------------------------------
$rarity-colors: (
    common: $rarity-color-common,
    uncommon: $rarity-color-uncommon,
    rare: $rarity-color-rare,
    epic: $rarity-color-epic,
    legendary: $rarity-color-legendary,
    mythic: $rarity-color-mythic
    // Добавьте сюда другие редкости, если они у вас есть и для них определены переменные
) !default;

$sp-bg-start: #2a0a4a; // Темно-фиолетовый для центра градиента
$sp-bg-end: #4a1a6a;   // Более светлый фиолетовый для краев (будет затемнен)

$item-popup-bg-start: #1a2a4a; // Начальный цвет градиента
$item-popup-bg-end: #0f1a30;
// --- ДОБАВЬТЕ ЭТИ ПЕРЕМЕННЫЕ ДЛЯ ЦВЕТОВ ТЕКСТА И UI ---
$text-primary-light: #ebebeb !default;    // Для заголовков, важных значений
$text-secondary-light: #c5c5c5 !default; // Для основного текста деталей (используется на строке 653)
$text-muted-light: #a0a0a0 !default;      // Для меток, субтитров, описаний (используется в .popup-description-area)
$text-dark-placeholder: #888888 !default;   // Для плейсхолдеров или неактивного текста
$golden-banner-bg: $rarity-color-legendary; // Используем ваш цвет для легендарной редкости как золотой
$golden-banner-text-dark: #422D00;     // Темный текст для золотого фона
$golden-banner-text-light: #fff;
$golden-color: #FFD700;// Цвета фона и разделителей для темных тем (примеры)
$background-element-dark: rgba(0, 0, 0, 0.2) !default; // Для фона областей, например, иконки
$divider-color-dark: rgba(120, 130, 160, 0.2) !default; // Для <hr> и разделителей border-bottom
// ---------------------------------------------------------

// --- БАЗОВЫЕ СТИЛИ СТРАНИЦЫ ---
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden; // ⛔ Запрещаем скролл всей страницы
    overscroll-behavior: contain; // ⛔ Блокируем "вытягивание" на iOS/Android
    font-family: sans-serif; // Добавлен базовый шрифт
}

// --- ОСНОВНОЙ КОНТЕЙНЕР ИНВЕНТАРЯ ---
.inventory {
    width: 100vw;
    height: 100dvh; // Используем dvh для лучшей поддержки мобильных

    // --- ИЗМЕНЕНИЕ ФОНА ---
    // Старый фон:
    // background: url("/assets/main-screen-bg.png") no-repeat center center/cover;
    // Новый фон:
    background: radial-gradient(ellipse at center, $sp-bg-start 0%, darken($sp-bg-end, 10%) 100%);
    // --- КОНЕЦ ИЗМЕНЕНИЯ ФОНА ---

    padding: 0;
    color: white; // Основной цвет текста на этом фоне, возможно, понадобится коррекция для контраста
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    box-sizing: border-box;
    position: relative;
}
.inventory-power-display {
    display: flex;
    align-items: baseline; // Важно для красивого выравнивания текста "Power:" и больших цифр
    justify-content: center;
    padding: 8px 15px;
    margin-top: 0; // Как мы установили ранее, отступ управляется gap'ом родителя
    background-color: rgba(10, 15, 40, 0.65);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    width: 100%; 
    max-width: 280px; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    text-align: center;
    flex-shrink: 0;

    .inventory-power-label { // Для текста "Power:"
        font-size: 24px;     // Текущий размер
        font-weight: bold;
        color: #FFD700;      // Текущий золотой цвет, хорошо сочетается с новым счетчиком
        margin-right: 8px;   // Отступ справа от "Power:"
        text-shadow: 0px 1px 1px rgba(0, 0, 0, 0.5);
        white-space: nowrap; // Чтобы "Power:" не переносилось, если вдруг что
    }

    .inventory-power-value { // Для цифр счетчика
        // --- ИЗМЕНЕНИЯ ---
        font-size: 24px;      // Увеличиваем размер шрифта (например, до 28px, настройте по вкусу)
        font-weight: 700;     // Оставляем жирным
        color: #FFD700;      // Делаем цифры золотыми
        line-height: 1;       // Может помочь с вертикальным выравниванием очень крупного текста
        // text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3); // Опционально: легкая тень для объема
        // --- КОНЕЦ ИЗМЕНЕНИЙ ---
    }
}
// --- СТИЛИ ДЛЯ ПЕРЕКЛЮЧЕНИЯ ЛЕЙАУТОВ ---
// Базовый класс для всех лейаутов
.inventory-layout {
    position: absolute;
    top: 0;
    margin-top: max(
        70px,
        calc(35px + env(safe-area-inset-top, 0px))
      ) !important;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex; // Используем flex для управления дочерними секциями
    flex-direction: column; // Располагаем секции вертикально
    align-items: center; // Центрируем секции по горизонтали
    padding: 15px; // Отступы по краям всего лейаута
    box-sizing: border-box;
    overflow: hidden; // Обрезаем то, что может выйти за пределы
    gap: 15px; // Расстояние между секциями по умолчанию
}

// ===========================================================
// === НАЧАЛО: СТИЛИ ДЛЯ ЛЕЙАУТА 1 (Normal - Gear/Stats) ====
// ===========================================================
.inventory-layout--normal {
    margin-top: -5px; // Добавлен отступ сверху

    // ===== 1. Секция Персонажа =====
.character-section {
    flex-shrink: 0;
    width: 100%;
    max-width: 580px; // Как было у вас
    margin: 0 auto;   // Горизонтальное центрирование самого блока .character-section
                      // Вертикальный отступ теперь будет управляться gap'ом родителя .inventory-layout--normal
    background-color: rgba(20, 25, 60, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 16px;
    padding: 10px;    // Существующий padding
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    box-sizing: border-box;

    // --- ДОБАВЛЕННЫЕ СТИЛИ для расположения .character-equip и .inventory-power-display ---
    display: flex;
    flex-direction: column; // Располагаем дочерние элементы (экипировка и сила) друг под другом
    align-items: center;    // Центрируем их по горизонтали
    gap: 10px; // Отступ между блоком экипировки и блоком силы (настройте по вкусу, можно 15px или 20px)
    // --- КОНЕЦ ДОБАВЛЕННЫХ СТИЛЕЙ ---

    .character-equip {
        // Стили для .character-equip остаются прежними
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 5px; // Как было у вас

            .left-column, .right-column {
                display: flex;
                flex-direction: column;
                gap: 15px;
                margin-top: 10px;
            }
            .left-column { margin-right: -20px; }
            .right-column { margin-left: -20px; }

            // --- Слоты экипировки ---
            .equipment-slot {
        width: 60px; height: 60px; border-radius: 10px;
        border: 2px solid transparent; 
        background-color: rgba(0, 0, 0, 0.25); // Фон слота
        display: flex; align-items: center; justify-content: center;
        cursor: pointer; 
        transition: transform 0.2s ease, border-color 0.2s ease, background-color 0.2s ease;
        position: relative; // Важно для позиционирования дочерних элементов

        img { 
            width: 42px; 
            height: 42px; 
            object-fit: contain; 
            position: relative; 
            z-index: 1; // Изображение под меткой уровня
        }
        .empty-slot { font-size: 22px; color: #aaa; }

                // Стили редкости для слотов
                &.rarity-common { border-color: $rarity-color-common !important; background: radial-gradient(ellipse at center, lighten($rarity-color-common, 15%), darken($rarity-color-common, 15%)) !important; }
                &.rarity-uncommon { border-color: $rarity-color-uncommon !important; background: radial-gradient(ellipse at center, lighten($rarity-color-uncommon, 10%), darken($rarity-color-uncommon, 20%)) !important; }
                &.rarity-rare { border-color: $rarity-color-rare !important; background: radial-gradient(ellipse at center, lighten($rarity-color-rare, 10%), darken($rarity-color-rare, 20%)) !important; }
                &.rarity-legendary { border-color: $rarity-color-legendary !important; background: radial-gradient(ellipse at center, lighten($rarity-color-legendary, 10%), darken($rarity-color-legendary, 20%)) !important; animation: pulse-legendary 2s infinite ease-in-out; }
                &.rarity-mythic { border-color: $rarity-color-mythic !important; background: radial-gradient(ellipse at center, lighten($rarity-color-mythic, 10%), darken($rarity-color-mythic, 20%)) !important; animation: pulse-mythic 1.8s infinite ease-in-out; }
                &.rarity-epic { 
                    border-color: $rarity-color-epic !important; 
                    background: radial-gradient(ellipse at center, lighten($rarity-color-epic, 10%), darken($rarity-color-epic, 20%)) !important;
                    // animation: pulse-epic 1.9s infinite ease-in-out; // Если нужна анимация
                }

                &:hover { border-color: #fff !important; transform: scale(1.05); }
            .equipped-item-level-badge {
            position: absolute;
            top: 0px;    // Отступ сверху
            left: 0px;   // Отступ слева (для левого верхнего угла)
            background-color: rgba(0, 0, 0, 0.75); // Темный полупрозрачный фон
            color: #FFD700; // Золотой цвет текста (можно заменить на белый: #f0f0f0)
            padding: 1px 4px; // Компактные отступы
            font-size: 10px;  // Маленький шрифт
            font-weight: bold;
            line-height: 1.2; // Для лучшего вертикального выравнивания текста
            border-radius: 3px; // Скругленные углы
            z-index: 2;       // Выше изображения предмета
            pointer-events: none; // Чтобы не мешал клику на слот
            border: 1px solid rgba(255, 255, 255, 0.1); // Очень тонкая светлая обводка (опционально)
            min-width: 14px; // Минимальная ширина для одной цифры
            text-align: center;
        }
        // ▲▲▲ КОНЕЦ НОВЫХ СТИЛЕЙ ▲▲▲
    } // Конец .equipment-slot
 // Конец .character-equip

            // --- Модель персонажа ---
            .character-model {
                position: relative; width: 250px; height: 250px;
                display: flex; align-items: center; justify-content: center;
                flex-shrink: 0;

                .character-viewer {
                    width: 100%; height: 100%;
                    canvas { width: 100% !important; height: 100% !important; display: block; background: transparent !important; }
                }

                // --- Контейнер стрелок ---
                .power-arrows-container {
                    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
                    pointer-events: none; overflow: hidden;
                    .power-arrow {
                        position: absolute; top: 50%; left: 50%;
                        width: 25px; height: auto; object-fit: contain;
                        filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.5));
                    }
                }
            } // Конец .character-model
        } // Конец .character-equip
    } // ===== Конец .character-section =====


// ===== 2. Секция Контента (Нижняя Панель) =====
.content-section {
    flex-grow: 1; // По умолчанию растягивается (для вкладок Gear, Artifacts)
    width: 100%; 
    max-width: 580px; 
    margin: 0 auto;
    display: flex; 
    flex-direction: column;
    background-color: rgba(20, 25, 60, 0.7); // Ваш фон
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 16px; 
    padding: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    box-sizing: border-box; 
    overflow: visible; 
    position: relative;

    // --- НОВЫЕ СТИЛИ для случая, когда активна вкладка "Stats" ---
    &.content-section--fit-content {
        flex-grow: 0;         // Запрещаем .content-section растягиваться по высоте
        height: auto;         // Высота .content-section определяется его содержимым
        align-self: flex-start; // Если родитель (.inventory-layout--normal) пытается растянуть/центрировать его по вертикали,
                                // это заставит .content-section прижаться к верху своей "ячейки" во flex-контейнере родителя.
    }

    // Стили для корневого элемента компонента InventoryTabs 
    // (предполагаем, что он имеет класс .inventory-tabs)
    > .inventory-tabs { 
        flex-shrink: 0;
        position: relative; 
        z-index: 10; // Выше, чтобы перекрывать предыдущий блок при необходимости

        // --- ИЗМЕНЕНИЕ: Увеличиваем отрицательный отступ сверху ---
        // Это значение подбирается. Если padding-top у .content-section = 15px,
        // а высота самого блока табов с его внутренними отступами ~50-60px,
        // то margin-top: -40px или -45px заставит его значительно "выйти" вверх.
        // Например, -40px означает, что верхний край табов будет на 25px (40-15) выше 
        // верхней границы фона .content-section.
        margin-top: -40px; 
        
        margin-left: auto;
        margin-right: auto;
        // Отступ снизу до .inventory-action-buttons-wrapper или .inventory-main-area
        // Можно немного уменьшить, если табы сильно поднялись
        margin-bottom: 0px; 

        width: fit-content;
        max-width: 90%;
        
        // --- ИЗМЕНЕНИЕ: Возвращаем и адаптируем стили "подиума" ---
        // Адаптируем padding "подиума" под увеличенные кнопки
        padding: 10px 15px 8px 15px; 
        border-radius: 10px 10px 0 0; // Скругление верхних углов "подиума" (можно сделать чуть меньше, чем у кнопок)
        display: flex;
        justify-content: center;
        align-items: center; 
        gap: 0px; // Отступ между кнопками (можно уменьшить, если кнопки стали шире)

        // Стили для самих кнопок-табов
        button {
            border: none; 
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
            font-weight: 600;

            // --- ИЗМЕНЕНИЕ: Делаем кнопки еще немного больше ---
            padding: 10px 22px; // Например, 10px вертикальный, 22px горизонтальный
            font-size: 16px;    // Увеличиваем шрифт
            border-radius: 8px 8px 8px 8px; // Скругление только верхних углов кнопок
            // --- КОНЕЦ ИЗМЕНЕНИЙ ---

            background: #4a5568; 
            color: #cbd5e0; 
            box-shadow: inset 0 -2px 0px rgba(0,0,0,0.1);

            &:hover:not(.active) { 
                background: #5a6578; 
                color: #fff; 
            }
            &:active:not(.active) { 
                transform: scale(0.97); 
            }

            &.active { 
                background: #FFA726; 
                color: #fff; 
                box-shadow: 0 -1px 4px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.25); 
                position: relative; 
            }
        }
    } // Конец > .inventory-tabs

    // --- Кнопки действий (прямой потомок .content-section) ---
    > .inventory-action-buttons-wrapper {
        flex-shrink: 0; 
        width: 100%; 
        max-width: 400px; 
        padding: 0 5px; 
        box-sizing: border-box;
        margin: 0 auto 15px auto; // Отступы: сверху 0 (т.к. .inventory-tabs уже дал margin-bottom), авто по бокам, 15px снизу
        display: flex; 
        justify-content: space-between; 
        align-items: center;

        .inventory-sort-button,
.inventory-forge-button {
  background-color: var(--button-secondary-bg, #4A5568); // Пример цвета фона
  color: var(--button-secondary-text, #E2E8F0);
  border: none;
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 6px; // Пространство между иконкой и текстом

  &:hover {
    background-color: var(--button-secondary-bg-hover, #2D3748);
  }

  .button-icon {
    width: 18px; // Настройте размер иконки
    height: 18px;
  }
}
        .inventory-sort-button { background-color: #667eea; color: white; &:hover { background-color: #7f8ff5; } }
        .inventory-forge-button {
            background-color: #A1887F; color: white; &:hover { background-color: #bcaaa4; }
            .forge-indicator {
                position: relative; top: -15px; right: -18px; width: 20px; height: 20px; font-size: 12px;
                background-color: #ef4444; color: white; font-weight: bold; border-radius: 50%;
                display: flex; align-items: center; justify-content: center; line-height: 1;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4); pointer-events: none;
            }
        }
    }

    // --- Основная область (Статы / Инвентарь) ---
    // Прямой потомок .content-section
> .inventory-main-area {
    flex-grow: 1; // По умолчанию растягивается (для вкладок Gear, Artifacts)
    width: 100%;
    overflow: hidden; 
    position: relative; 
    border-radius: 12px; 
    background-color: rgba(20, 10, 40, 0.6); // Ваш фон для этой области
    border: 1px solid rgba(100, 80, 130, 0.3); 
    box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.3); 
    
    display: flex; 
    align-items: flex-start; // Прижимает .stats-panel к верху
    justify-content: center; // Центрирует .stats-panel по горизонтали

    // --- НОВЫЕ СТИЛИ для случая, когда активна вкладка "Stats" ---
    &.inventory-main-area--fit-content {
        flex-grow: 0;         // Запрещаем растягиваться по высоте
        height: auto;         // Высота определяется содержимым (.stats-panel)
        align-self: flex-start; // Дополнительно гарантируем прижатие к верху в контексте родителя (.content-section)
                                // Это может быть полезно, если .content-section очень высокий.
    }
    // --- КОНЕЦ НОВЫХ СТИЛЕЙ ---


.stats-panel {
    background-color: transparent; 
    border: none; 
    box-shadow: none;
    padding: 10px 5px;  // Внутренние отступы самой панели статов
    margin: 0 auto;     // Горизонтальное центрирование панели статов
    width: 100%;
    max-width: 360px; 
    overflow-y: auto; 
    box-sizing: border-box;
    height: auto; // Высота панели по контенту

    // Стили для кастомного скроллбара (если нужен и виден)
    &::-webkit-scrollbar { width: 8px; }
    &::-webkit-scrollbar-track { background: rgba(10, 5, 25, 0.3); border-radius: 4px; }
    &::-webkit-scrollbar-thumb { background-color: rgba(120, 100, 150, 0.6); border-radius: 4px; /* ... */ }
    &::-webkit-scrollbar-thumb:hover { background-color: rgba(140, 120, 170, 0.8); }

    p { // Стили для каждой строки характеристики
        display: flex;
        align-items: center; 
        justify-content: space-between; 

        // --- УБИРАЕМ ВЕРТИКАЛЬНЫЕ MARGIN У СТРОК ---
        margin: 0; 
        font-size: 15px;
        
        // --- ДЕЛАЕМ ФОН СТРОКИ ПРОЗРАЧНЫМ ---
        background-color: transparent; 
        
        // --- ПАДДИНГИ ДЛЯ ВЫСОТЫ СТРОКИ И ОТСТУПОВ ТЕКСТА ---
        padding: 10px 10px; // Уменьшаем вертикальный padding, если нужно еще компактнее (было 12px)

        // --- ДОБАВЛЯЕМ ТОЛЬКО BORDER-BOTTOM ---
        border: none; // Убираем все предыдущие рамки
        border-bottom: 1px solid rgba(120, 100, 150, 0.25); // Тонкий разделитель

        transition: background-color 0.2s ease;

        &:hover {
            background-color: rgba(30, 20, 60, 0.15); // Легкий фон при наведении (если нужен)
        }

        // Иконки убраны (псевдоэлемент ::before скрыт или удален)
        &::before { 
            display: none; 
        }

        .stat-label { 
            flex-grow: 0; 
            color: $text-secondary-light; 
            font-weight: 500;
            margin-right: 10px; 
        }
        .stat-value { 
            color: $text-primary-light; 
            font-weight: 600; 
            text-align: right; 
        }

        // У последней строки убираем нижний разделитель
        &:last-child {
            border-bottom: none;
        }
    }
    // Стили для hr.stats-divider уже должны быть удалены, так как сам элемент удален из JSX
}

        .inventory-gear-wrapper {
 height: 100%;           // Должен занимать 100% высоты .inventory-main-area
        display: flex;
        flex-direction: column;
        width: 100%;
        overflow: hidden;       // Обрезает то, что может выйти за пределы
        min-height: 0;          // <--- САМЫЙ ВАЖНЫЙ ФИКС ДЛЯ ЭТОЙ ПРОБЛЕМЫ!

            .inventory-scroll-wrapper {
               flex-grow: 1; 
            width: 100%; 
            overflow-y: auto; // Теперь это должно р// Принудительно показать скроллбар
                        flex-basis: 0;          // Хорошо добавить для flex-grow

                overflow-x: hidden;
                padding: 0px; 
                box-sizing: border-box;
                margin-bottom: 120px;

                 &::-webkit-scrollbar {
            display: none; // Можно также использовать width: 0; height: 0;
        }
        

                .inventory-items {
                    display: grid !important;
                    grid-template-columns: repeat(5, 1fr); // Или ваша адаптивная версия
                    gap: 12px; 
                    padding: 0; 
                    width: 100%; 
                    height: max-content; 

                    .inventory-item {
                        width: 100%; 
                        padding-bottom: 100%; 
                        height: 0; 
                        position: relative; // Важно для позиционирования дочерних элементов
                        border-radius: 8px; 
                        border: 2px solid transparent; 
                        background-color: rgba(0, 0, 0, 0.2);
                        cursor: pointer; 
                        transition: transform 0.2s ease, border-color 0.2s ease, box-shadow 0.2s ease;

                        img {
                            position: absolute; 
                            top: 50%; 
                            left: 50%; 
                            transform: translate(-50%, -50%);
                            max-width: 75%; 
                            max-height: 75%; 
                            width: auto; 
                            height: auto;
                            object-fit: contain; 
                            display: block;
                        }

                        .equipped-indicator {
                            position: absolute; 
                            bottom: 2px; 
                            right: 2px; 
                            width: 18px; 
                            height: 18px;
                            background-color: $rarity-color-legendary; 
                            color: #000; 
                            border-radius: 50%;
                            font-size: 11px; 
                            font-weight: bold; 
                            display: flex; 
                            align-items: center;
                            justify-content: center; 
                            line-height: 1; 
                            box-shadow: 0 0 3px rgba(0,0,0,0.5);
                            z-index: 2;
                        }

                        // ▼▼▼ ВОТ СЮДА НУЖНО ДОБАВИТЬ СТИЛИ ДЛЯ .new-item-label ▼▼▼
                       .new-item-label {
            position: absolute;
            // --- ИЗМЕНЕНИЕ ПОЗИЦИИ НА ВЕРХНИЙ ЛЕВЫЙ УГОЛ ---
            top: 0px;     // Небольшой отступ сверху
            left: 0px;    // Небольшой отступ слева
            // --- КОНЕЦ ИЗМЕНЕНИЯ ПОЗИЦИИ ---
            background-color: #e53e3e; 
            color: white;
            padding: 1px 5px; // Чуть изменим паддинг для компактности
            font-size: 9px;   // Шрифт чуть меньше
            font-weight: bold;
            line-height: 1.2; // Для лучшего вертикального выравнивания
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.4);
            z-index: 150; 
            pointer-events: none;
        }

        // ▼▼▼ НОВЫЕ СТИЛИ ДЛЯ МЕТКИ УРОВНЯ ▼▼▼
        .item-level-badge {
            position: absolute;
            top: 0px;
            left: 0px;
            background-color: rgba(0, 0, 0, 0.65); // Полупрозрачный темный фон
            color: #FFD700; // Золотистый цвет для текста уровня (или белый: #f0f0f0)
            padding: 2px 5px;
            font-size: 10px;
            font-weight: bold;
            line-height: 1;
            border-radius: 4px;
            z-index: 3; // Такой же или выше, чем у new-item-label, если могут пересекаться (здесь не должны)
            pointer-events: none;
            border: 1px solid rgba(255, 255, 255, 0.15); // Очень тонкая светлая обводка
            box-shadow: 0 1px 2px rgba(0,0,0,0.3);

            .level-text { // Для слова "Lvl", если вы его используете
                font-size: 8px; // Чуть меньше, чем цифра уровня
                opacity: 0.8;
                margin-right: 2px; // Небольшой отступ
            }
        }
                        // ▲▲▲ КОНЕЦ СТИЛЕЙ ДЛЯ .new-item-label ▲▲▲
                        &.rarity-common { border-color: $rarity-color-common !important; background: radial-gradient(ellipse at center, lighten($rarity-color-common, 15%), darken($rarity-color-common, 15%)) !important; }
                        &.rarity-uncommon { border-color: $rarity-color-uncommon !important; background: radial-gradient(ellipse at center, lighten($rarity-color-uncommon, 10%), darken($rarity-color-uncommon, 20%)) !important; }
                        &.rarity-rare { border-color: $rarity-color-rare !important; background: radial-gradient(ellipse at center, lighten($rarity-color-rare, 10%), darken($rarity-color-rare, 20%)) !important; }
                        &.rarity-legendary { border-color: $rarity-color-legendary !important; background: radial-gradient(ellipse at center, lighten($rarity-color-legendary, 10%), darken($rarity-color-legendary, 20%)) !important; animation: pulse-legendary 2s infinite ease-in-out; }
                        &.rarity-mythic { border-color: $rarity-color-mythic !important; background: radial-gradient(ellipse at center, lighten($rarity-color-mythic, 10%), darken($rarity-color-mythic, 20%)) !important; animation: pulse-mythic 1.8s infinite ease-in-out; }
                        &.rarity-epic { 
                            border-color: $rarity-color-epic !important; 
                            background: radial-gradient(ellipse at center, lighten($rarity-color-epic, 10%), darken($rarity-color-epic, 20%)) !important;
                        }
                        &:hover { border-color: #fff !important; transform: scale(1.03); }
                    }
                    .empty-inventory-message {
                        grid-column: 1 / -1; text-align: center; color: #a0aec0;
                        padding: 20px; font-style: italic;
                    }
                }
            }
        }
    }
}
}

// ===========================================================
// === СТИЛИ ДЛЯ ЛЕЙАУТА 2 (Artifacts) ====
// ===========================================================
.inventory-layout--artifacts {
  // margin-top: 50px; // Этот отступ был в твоем коде.
                     // Убедись, что он все еще нужен, учитывая базовый margin-top у .inventory-layout.
                     // Если .inventory-layout уже корректно позиционируется, этот margin может быть избыточен.

  // Стили для .content-section--artifacts, который теперь содержит табы
 .content-section--artifacts {
    flex-grow: 1;
    width: 100%;
    max-width: 580px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    overflow: visible;   // Оставляем для "выпирания" табов
    background: linear-gradient(180deg, rgba(50, 40, 70, 0.85), rgba(40, 30, 55, 0.9));
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 16px;
    padding: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    box-sizing: border-box;
    position: relative;
    min-height: 0; // <--- ДОБАВЛЕНО ЗДЕСЬ

    // Стили для табов, ВЛОЖЕННЫЕ в .content-section--artifacts
    // Эти стили идентичны .inventory-layout--normal .content-section > .inventory-tabs
    > .inventory-tabs {
      flex-shrink: 0;
      position: relative;
      z-index: 10; // Табы должны быть выше фона .content-section--artifacts

      margin-top: -40px; // "Выталкивает" табы вверх, используя padding-top родителя
      margin-left: auto;
      margin-right: auto;
      // Отступ снизу до .inventory-main-area--artifacts
      // В normal layout здесь margin-bottom: 0px; и отступ создается gap'ом родителя (.content-section)
      // Если .content-section--artifacts тоже будет иметь gap, то можно 0px.
      // Либо задать здесь явный margin-bottom, например 15px.
      // Пока оставим 0px, как в normal layout.
      margin-bottom: 0px;

      width: fit-content;
      max-width: 90%;

      padding: 10px 15px 8px 15px; // "Подиум" для самих табов
      border-radius: 10px 10px 0 0; // Скругление верхних углов "подиума"
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0px; // Отступ между кнопками

      button {
        border: none;
        cursor: pointer;
        transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
        font-weight: 600;
        padding: 10px 22px;
        font-size: 16px;
        border-radius: 8px; // Кнопки полностью скругленные

        background: #4a5568;
        color: #cbd5e0;
        box-shadow: inset 0 -2px 0px rgba(0,0,0,0.1);

        &:hover:not(.active) {
          background: #5a6578;
          color: #fff;
        }
        &:active:not(.active) {
          transform: scale(0.97);
        }

        &.active {
          background: #FFA726;
          color: #fff;
          box-shadow: 0 -1px 4px rgba(0,0,0,0.15), 0 1px 3px rgba(0,0,0,0.25);
          position: relative;
        }
      }
    } // Конец > .inventory-tabs

    .inventory-main-area--artifacts {
      flex-grow: 1;
      overflow-y: auto;
      width: 100%;
      // padding: 15px; // Этот padding теперь будет от родительского .content-section--artifacts
      // Поэтому здесь padding может быть 0 или специфичный для этой области, если нужен дополнительный.
      // В normal layout у .inventory-main-area нет своего padding.
      // Для консистентности, если .content-section--artifacts имеет padding: 15px,
      // то .inventory-main-area--artifacts может не нуждаться в дополнительном padding.
      // Но если ты хочешь, чтобы у inventory-main-area--artifacts был такой же фон и рамка, как в normal,
      // то нужно скопировать его стили:
      border-radius: 12px;
      background-color: rgba(20, 10, 40, 0.6); // Фон из normal layout .inventory-main-area
      border: 1px solid rgba(100, 80, 130, 0.3); // Рамка из normal layout .inventory-main-area
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.3); // Тень из normal layout .inventory-main-area
      // margin-top: 15px; // Если у .inventory-tabs margin-bottom: 0, этот отступ отделит контент от табов.
                          // В normal layout этот отступ создается gap'ом родителя .content-section.
                          // Если .content-section--artifacts тоже имеет gap (например, если он display:flex, flex-direction:column), то этот margin может не понадобиться.

      box-sizing: border-box;


      &::-webkit-scrollbar { width: 8px; }
      &::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.1); border-radius: 4px; } // Стили скроллбара из твоего кода
      &::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.3); border-radius: 4px; border: 2px solid transparent; background-clip: content-box; }
      &::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.5); }
    }
  } // Конец .content-section--artifacts
} // Конец .inventory-layout--artifacts

// ===========================================================
// === НАЧАЛО: ОБЩИЕ СТИЛИ ДЛЯ ТАБОВ ===
// ===========================================================
    .inventory-tabs {
    flex-shrink: 0; 
    display: flex;          // Эти свойства будут применены ко всем .inventory-tabs
    justify-content: center; 
    align-items: center;    // Добавлено для вертикального центрирования кнопок, если их высота разная
    gap: 10px;              // Отступ между кнопками-табами

    // Стили для самих кнопок-табов
    button {
        background: #4a5568; 
        color: #cbd5e0; 
        border: none; 
        border-radius: 8px;
        padding: 8px 20px; 
        font-weight: 600; 
        font-size: 15px; 
        cursor: pointer;
        transition: background 0.2s ease, color 0.2s ease, transform 0.1s ease, box-shadow 0.2s ease;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);

        &:hover { 
            background: #5a6578; 
            color: #fff; 
        }
         &:active { 
            transform: scale(0.97); 
        }
            &.active { 
            background: #FFA726; // Оранжевый для активного таба (как на скриншоте image_6c74d2.png)
            color: #fff; 
            box-shadow: 0 0 10px rgba(255, 167, 38, 0.5), 0 2px 5px rgba(0,0,0,0.3); 
        }
    }
}
// ===========================================================
// === КОНЕЦ: ОБЩИЕ СТИЛИ ДЛЯ ТАБОВ ===
// ===========================================================


// ===========================================================
// === НАЧАЛО: ОБНОВЛЕННЫЕ СТИЛИ ПОПАПА (из Код 1) ===
// ===========================================================
// Используем класс `.item-popup-backdrop` для оверлея
.item-popup-backdrop {
    // Overlay styles
    position: fixed; top: 0; left: 0; width: 100vw; height: 100dvh; // Используем dwh
    background: rgba(0, 0, 0, 0.8); // Чуть темнее фон
    display: flex; align-items: center; justify-content: center;
    z-index: 200; padding: 15px; box-sizing: border-box;

    
    // Контейнер контента попапа
    .item-popup-content {
        width: 380px; // Слегка увеличим ширину для нового макета
        max-width: 95vw;
        background: linear-gradient(160deg, $item-popup-bg-start, $item-popup-bg-end);
        border: 1px solid rgba(120, 130, 160, 0.4);
        border-radius: 12px;
        color: #e0e5f0;
        box-shadow: 0 6px 20px rgba(0,0,0,0.5);
        position: relative;
        padding-top: 0; // Шапка имеет свой паддинг
        display: flex;
        flex-direction: column;
        max-height: 90vh; // Чуть больше высоты
        overflow: visible;

        // Кнопка закрытия X
        .popup-close-x {
            position: absolute;
            top: 10px;   // Возможно, потребуется поднять чуть выше или настроить
            right: 10px;
            background: rgba(0,0,0,0.3);
            border: 1px solid transparent;
            color: #aaa;
            font-size: 20px;
            line-height: 1;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1050; // Убедитесь, что z-index ВЫШЕ чем у баннеров шапки
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;

            &:hover, &:focus {
                background: rgba(0,0,0,0.5);
                color: #fff;
                border-color: rgba(255,255,255,0.3);
                transform: scale(1.1);
                outline: none;
            }
        }

        // Новый контейнер для всех элементов шапки
        .custom-popup-header {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 25px 15px 15px 15px; 
            gap: 8px; 
            border-bottom: 1px solid $divider-color-dark; 
            width: 100%;
            box-sizing: border-box;
            flex-shrink: 0;
        }

        .item-name-banner {
            display: inline-block;
            padding: 2px 2px;
            border-radius: 8px;
            color: white;
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.45); 
            position: relative; 
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.5); 
            z-index: 3; 
            max-width: 70%;
            margin-top: -50px; 
            
            @each $rarity, $color in $rarity-colors {
                &.rarity-bg-#{$rarity} {
                    background-color: $color;
                    @if (lightness($color) > 65%) {
                        color: #2c3e50;
                    } @else {
                        color: white;
                    }
                }
            }

            .rarity-text-indicator {
                display: block;
                font-size: 11px;
                font-weight: normal;
                opacity: 0.8;
                margin-top: 3px;
                @each $rarity, $color in $rarity-colors {
                    &.rarity-#{$rarity} {
                        @if (lightness($color) > 65%) { color: darken($color, 40%); }
                        @else { color: lighten($color, 40%); }
                    }
                }
            }
        }

        // Баннер с типом предмета
        .item-type-banner {
            display: inline-block;
            background-color: $golden-banner-bg;
            color: $golden-banner-text-dark;
            padding: 6px 18px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            text-transform: capitalize;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        // Баннер с текущим уровнем
        .current-level-banner {
            position: absolute;
            top: 5px;    
            left: 1px;   
            background-color: $golden-banner-bg;
            color: $golden-banner-text-dark;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            z-index: 5; 
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            
            span { display: block; }
        }

        // 2. Основное тело попапа
        .popup-body {
            padding: 15px 20px; 
            // overflow-y: auto; 

            .popup-content-stack {
                display: flex;
                flex-direction: column;
                align-items: center; 
                gap: 18px; 
                width: 100%;
                max-width: 380px; 
                margin: 0 auto;  

                // --- ЭТАЖ 1: Иконка и Описание ---
                .icon-description-row {
                    display: flex;
                    flex-direction: row;   
                    align-items: flex-start; 
                    gap: 15px;             
                    width: 100%;           

                    .icon-column { 
                        flex: 0 0 90px; 

                        .popup-icon-area {
                            width: 90px;
                            height: 90px;
                            padding: 6px; 
                            border-radius: 6px;
                            border: 2px solid transparent; 
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            box-sizing: border-box;

                            @each $rarity, $color in $rarity-colors {
                                &.rarity-#{$rarity} {
                                    border-color: $color; 
                                    background: radial-gradient(ellipse at center, lighten($color, 15%), darken($color, 20%));
                                }
                            }

                            .popup-icon { 
                                max-width: 100%;
                                max-height: 100%;
                                object-fit: contain;
                                // image-rendering: pixelated; 
                            }
                        }
                    }

                    .description-column { 
                        flex: 1; 
                        min-width: 0; 

                        .popup-description-area { 
                            background-color: rgba(0, 0, 0, 0.15); 
                            padding: 12px 15px;           
                            border-radius: 6px;           
                            width: 100%;                  
                            box-sizing: border-box;
                            font-size: 13px;
                            line-height: 1.5;
                            color: $text-secondary-light; 
                            
                            p {
                                margin: 0; 
                            }
                        }
                    }
                }

                .stats-block { // Существующие стили для .stats-block
                    background-color: rgba(0, 0, 0, 0.15); 
                    padding: 15px;                        
                    border-radius: 8px;                   
                    margin-bottom: 5px;                   
                    width: 100%;                          
                    box-sizing: border-box; 

                    .stats-comparison-table {
                        display: grid;
                        grid-template-columns: minmax(100px, 1.6fr) 1fr auto 1fr; 
                        column-gap: 8px;
                        row-gap: 5px;
                        font-size: 13px;
                        width: 100%;
                        align-items: center;

                        .stat-cell, .stat-name-cell, .current-value-cell, .arrow-cell, .next-value-cell {
                            padding: 3px 0;
                            display: flex;
                            align-items: center;
                        }

                        .stat-name-cell {
                            justify-content: flex-start; 
                        }

                        .current-value-cell {
                            justify-content: center;   
                            font-weight: 700;
                            color: $text-primary-light;
                        }

                        .arrow-cell {
                            justify-content: center;   
                            color: $bright-green-arrow;
                            font-weight: 700;
                        }

                        .next-value-cell {
                            justify-content: center;  
                            font-weight: 700;

                            &.has-value { 
                                color: $bright-green-arrow;
                            }
                            &.no-value { 
                                color: $text-primary-light; 
                            }
                            &.no-upgrade { 
                                color: $text-muted-light;
                                font-weight: 500; 
                            }
                        }
                    }
                }

                // --- ЭТАЖ 3: Бонус Комплекта --- (Существующие стили для плейсхолдера бонуса комплекта)
                .popup-set-bonus-area {
                    width: 100%;
                    max-width: 340px; 
                    margin: 0 auto;   
                    font-size: 13px;
                    line-height: 1.5;
                    color: $text-muted-light;
                    h4 {
                        font-size: 14px;
                        font-weight: 600;
                        color: $text-secondary-light;
                        margin: 0 0 6px 0;
                    }
                    p { margin: 0; &:not(:last-child) { margin-bottom: 5px; } }
                }

                // --- Разделители ---
                .popup-divider {
                    border: none;
                    height: 1px;
                    background-color: $divider-color-dark;

                    &.content-divider {
                        width: 100%;
                        margin: 0; 
                    }
                    &.thin {
                        // margin: 4px 0; 
                    }
                }

                // ▼▼▼ НАЧАЛО СТИЛЕЙ ДЛЯ ПЕРЕКЛЮЧАЕМОГО КОНТЕНТА (Вставлено ранее) ▼▼▼
                .toggleable-content-area {
                    position: relative;
                    width: 100%;
                    min-height: 180px; 
                    margin-bottom: 10px; 
                }

                .stats-view-wrapper,     
                .set-bonuses-view-wrapper { 
                    width: 100%;
                    box-sizing: border-box;
                    // position: absolute;
                    // top: 0;
                    // left: 0;
                }

                .popup-set-bonus-area {
                    &.actual-set-bonuses { 
                        padding: 15px;
                        width: 100%;
                        box-sizing: border-box;
                        background-color: rgba(0,0,0,0.25); 
                        border-radius: 8px;
                        color: $text-secondary-light;

                        h4 { 
                            font-size: 18px;
                            font-weight: 700;
                            color: $golden-banner-bg; 
                            margin: 0 0 15px 0;
                            text-align: center;
                            text-shadow: 0 1px 2px rgba(0,0,0,0.4);
                        }

                        .set-bonus-entry {
                            display: flex;
                            align-items: flex-start; 
                            font-size: 14px;
                            line-height: 1.5; 
                            color: $text-secondary-light;
                            padding: 8px 0;
                            border-bottom: 1px dashed $divider-color-dark; 

                            &:last-child {
                                border-bottom: none;
                                padding-bottom: 0; 
                            }
                            &:first-of-type {
                                padding-top: 0;
                            }

                            .set-bonus-count { 
                                font-weight: 600;
                                color: $text-primary-light; 
                                margin-right: 10px;
                                white-space: nowrap; 
                                flex-shrink: 0; 
                            }

                            .set-bonus-desc { 
                                // Стили для описания бонуса, если нужны
                            }
                        }
                    }
                }
                // ▲▲▲ КОНЕЦ СТИЛЕЙ ДЛЯ ПЕРЕКЛЮЧАЕМОГО КОНТЕНТА (Вставлено ранее) ▲▲▲

                // Стили для кнопки .button-toggle-view-standalone
                .button-toggle-view-standalone {
                    padding: 10px 20px;
                    font-size: 15px;
                    font-weight: 600;
                    border-radius: 7px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    min-height: 44px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border: 1px solid transparent;
                    box-shadow: 0 1px 3px rgba(0,0,0,0.15);
                    color: $text-primary-light;

                    &:hover {
                        transform: translateY(-1px);
                        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
                    }
                    &:active{
                        transform: translateY(0px);
                        box-shadow: 0 1px 2px rgba(0,0,0,0.15);
                    }
                    &:focus {
                        outline: none;
                    }
                    // Специфичные стили для button-toggle-view-standalone
                    width: 90%; 
                    max-width: 280px; 
                    margin-top: 5px; // Этот отступ будет работать в дополнение к 'gap' родителя .popup-content-stack, если кнопка является его прямым потомком
                    background: linear-gradient(180deg, #3a6278, #2e4f60);
                    border-color: #294554;
                    // color: $text-primary-light; // Уже определено выше
                    &:hover { // Эти стили для :hover будут дополнять/переопределять предыдущие :hover
                        background: linear-gradient(180deg, #437088, #355b6e);
                        border-color: #315263;
                        // transform: translateY(-1px); // Уже определено выше
                        // box-shadow: 0 2px 5px rgba(0,0,0,0.2); // Уже определено выше
                    }
                    &:focus { // Этот :focus переопределит предыдущий
                        box-shadow: 0 0 0 3px rgba(58, 98, 120, 0.5);
                    }
                }

            } // Конец .popup-content-stack
        } // Конец .popup-body

        // 3. Футер с кнопками
        .popup-buttons {
            padding: 12px;
            border-top: 1px solid rgba(120, 130, 160, 0.3);
            border-radius: 0 0 11px 11px;
            display: flex;
            flex-direction: column; 
            align-items: center;   
            gap: 12px;            

            .upgrade-action-group,
            .action-button-row,
            .button-group-placeholder {
                width: 90%; 
                max-width: 320px; 
                display: flex;
                flex-direction: column; 
                align-items: stretch;   
                gap: 8px; 
            }

            .button-group-placeholder {
                min-height: 88px;
            }

            .button-upgrade {
                width: 100%;
                background: linear-gradient(to bottom, hsl(195, 70%, 60%), hsl(195, 70%, 45%));
                border: 1px solid hsl(195, 70%, 40%);
                color: white;
                padding: 6px 10px;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.2s;
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                line-height: 1.25;
                box-shadow: 0 1px 2px rgba(0,0,0,0.1);
                min-height: 50px;

                &:hover:not(:disabled) {
                    background: linear-gradient(to bottom, hsl(195, 70%, 65%), hsl(195, 70%, 50%));
                }
                &:disabled {
                    background: linear-gradient(to bottom, #777, #555) !important;
                    border-color: #444 !important;
                    color: #aaa !important;
                    cursor: default;
                    opacity: 0.8;
                }

                .upgrade-action-text { 
                    font-size: 14px;
                    font-weight: bold;
                }

                .upgrade-cost-display { 
                    font-size: 12px;      
                    opacity: 0.95;        
                    white-space: nowrap;
                    margin-top: 3px;      
                    display: flex;        
                    align-items: center;
                    justify-content: center; 
                    gap: 8px;             

                    .cost-item { 
                        display: inline-flex; 
                        align-items: center;
                        gap: 3px;           

                        span { 
                            font-weight: 600; 
                        }
                    }

                    .cost-gold {
                        span { 
                            color: $golden-color; 

                            &.insufficient-funds { 
                                color: #E74C3C; 
                            }
                        }
                    }
                    .cost-diamonds {
                        span { 
                            &.insufficient-funds { 
                                color: #E74C3C; 
                            }
                        }
                    }

                    .cost-icon { 
                        width: 1em;  
                        height: 1em;
                    }

                    .cost-info-text { 
                        color: white; 
                        opacity: 0.8;
                    }
                }
            }

            .player-currency-panel {
                width: 100%; 
                background-color: rgba(0, 0, 0, 0.25); 
                color: #e0e5f0;
                padding: 8px 10px; 
                border: 1px solid rgba(120, 130, 160, 0.25); 
                border-radius: 8px; 
                box-sizing: border-box;
                font-size: 12px; 
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 6px; 
                min-height: 30px; 
                
                .currency-display {
                    display: inline-flex; 
                    align-items: center;
                    gap: 4px; 
                }

                .currency-icon {
                    width: 14px;
                    height: 14px;
                }

                .currency-separator {
                    margin: 0 2px; 
                }
            }

            .action-button-row {
                button.button-action {
                    width: 100%; 
                    padding: 10px 15px;
                    font-size: 14px;
                    min-height: 50px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: 600;
                    cursor: pointer;
                    transition: all 0.2s;
                    border-radius: 8px;
                    box-sizing: border-box;
                    border-style: solid;
                    border-width: 1px;

                    &:disabled {
                        background: linear-gradient(to bottom, #777, #555) !important;
                        border-color: #444 !important;
                        color: #aaa !important;
                        cursor: default;
                        opacity: 0.8;
                    }
                }

                .button-equip {
                    background: linear-gradient(to bottom, #5cb85c, #449d44);
                    border-color: #398439;
                    color: white;
                    &:hover:not(:disabled) {
                        background: linear-gradient(to bottom, #6fca6f, #55b055);
                    }
                }
                .button-unequip {
                    background: linear-gradient(to bottom, #d9534f, #c9302c);
                    border-color: #ac2925;
                    color: white;
                    &:hover:not(:disabled) {
                        background: linear-gradient(to bottom, #e0635f, #d43f3a);
                    }
                }
                .button-change {
                    background: linear-gradient(to bottom, #f0ad4e, #ec971f);
                    border-color: #d58512;
                    color: white;
                    &:hover:not(:disabled) {
                        background: linear-gradient(to bottom, #f3bd6a, #f0a73e);
                    }
                }
            }
        }
    } // Конец .item-popup-content
} // Конец .item-popup-backdrop

// ===========================================================
// === КОНЕЦ: ОБНОВЛЕННЫЕ СТИЛИ ПОПАПА ===
// ===========================================================

// --- АНИМАЦИИ (Оставляем из предыдущего кода для слотов/предметов) ---
@keyframes pulse-legendary {
    0% { box-shadow: 0 0 8px 2px rgba(color.adjust($rarity-color-legendary, $alpha: -0.4), 0.6), inset 0 0 5px 1px rgba(lighten($rarity-color-legendary, 20%), 0.4); border-color: $rarity-color-legendary;}
    50% { box-shadow: 0 0 12px 4px rgba(color.adjust($rarity-color-legendary, $alpha: -0.2), 0.8), inset 0 0 7px 2px rgba(lighten($rarity-color-legendary, 20%), 0.6); border-color: lighten($rarity-color-legendary, 15%);}
    100% { box-shadow: 0 0 8px 2px rgba(color.adjust($rarity-color-legendary, $alpha: -0.4), 0.6), inset 0 0 5px 1px rgba(lighten($rarity-color-legendary, 20%), 0.4); border-color: $rarity-color-legendary;}
}

@keyframes pulse-mythic {
    0% { box-shadow: 0 0 10px 3px rgba(color.adjust($rarity-color-mythic, $alpha: -0.3), 0.7), inset 0 0 6px 1px rgba(lighten($rarity-color-mythic, 20%), 0.5); border-color: $rarity-color-mythic;}
    50% { box-shadow: 0 0 15px 5px rgba(color.adjust($rarity-color-mythic, $alpha: -0.1), 0.9), inset 0 0 8px 2px rgba(lighten($rarity-color-mythic, 20%), 0.7); border-color: lighten($rarity-color-mythic, 15%);}
    100% { box-shadow: 0 0 10px 3px rgba(color.adjust($rarity-color-mythic, $alpha: -0.3), 0.7), inset 0 0 6px 1px rgba(lighten($rarity-color-mythic, 20%), 0.5); border-color: $rarity-color-mythic;}
}